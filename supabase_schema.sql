-- Create Public Offices Table for Summary Page Directory
CREATE TABLE IF NOT EXISTS public_offices (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_id BIGINT REFERENCES users(id),
  office_name TEXT NOT NULL,
  phone TEXT NOT NULL,
  whatsapp TEXT NOT NULL,
  work_type TEXT NOT NULL, -- 'online' or 'office'
  city TEXT,
  services JSONB, -- Array of strings
  is_golden BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable RLS
ALTER TABLE public_offices ENABLE ROW LEVEL SECURITY;

-- Policies (Permissive for this app structure)
CREATE POLICY "Enable read access for all users" ON public_offices FOR SELECT USING (true);
CREATE POLICY "Enable insert for authenticated users" ON public_offices FOR INSERT WITH CHECK (true);
CREATE POLICY "Enable update for owners" ON public_offices FOR UPDATE USING (true);
CREATE POLICY "Enable delete for owners" ON public_offices FOR DELETE USING (true);
